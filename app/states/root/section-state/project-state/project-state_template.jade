.project-close-button.scrollable-header(
	ng-click='closeProject(  )'
)


.project-page-wrapper.scrollable-content.ng-baguette

	throbber-directive
	
	.project-page-header-image-gallery-wrapper
		.project-page-header-image-wrapper.gallery( 
			ng-if='!mobile'
	    	ng-show='activeItem.primary_image.name.url'
		)
			a.project-page-header-image(
				href='{{ activeItem.primary_image.name.url }}'
				data-caption='{{ image.title }}'
			)
				img.project-page-header-image(
					ng-src='{{ activeItem.primary_image.name.url }}'
					ng-class='{ "people-header-image": stateParams.m === "person" }'
				)
	
	//- Mobile header image
	.project-page-header-image-gallery-wrapper
		.project-page-header-image-wrapper.gallery( 
			ng-if='mobile'
	    	ng-show='activeItem.primary_image.name'
		)
			a.project-page-header-image(
				href='{{ activeItem.primary_image.name.mobile.url }}'
				data-caption='{{ image.title }}'
			)
				img.project-page-header-image(
					ng-src='{{ activeItem.primary_image.name.mobile.url }}'
					ng-class='{ "people-header-image": stateParams.m === "person" }'
				)

	.project-page-content-wrapper

		.project-page-header-text( ng-bind-html='activeItem.title || activeItem.name | htmlParse' )
		
		//- PROJECT PAGE
		.project-page-text-wrapper( ng-if='( stateParams.section === "search" && stateParams.m == "project" ) || ["architecture", "research", "tangents", "research", "urban"].indexOf(stateParams.section) != -1 || ( stateParams.section === "about" && stateParams.m === "project" )' )

			.project-page-sidebar(ng-if='activeItem')

				//- Details
				.project-page-sidebar-section
					.project-page-sidebar-header
						| Details
					.project-detail-wrapper( ng-if='activeItem.city || activeItem.country' )
						.project-detail-label
							| Location: 
						.project-detail-text
							a(ng-href="http://maps.google.com/?q={{ printAddress(activeItem) }}" target="_blank")
								| {{ printAddress(activeItem) }}
					.project-detail-wrapper( ng-if='activeItem.client' )
						.project-detail-label
							| Client:
						.project-detail-text
							| {{ activeItem.client }}
					.project-detail-wrapper( ng-if='activeItem.site_area' )
						.project-detail-label
							| Site Area: 
						.project-detail-text
							| {{ activeItem.site_area }} acres / {{ activeItem.site_area * 0.404686 | number:2 }} hectares
					.project-detail-wrapper( ng-if='activeItem.size' )
						.project-detail-label
							| Size:
						.project-detail-text
							| {{ activeItem.size | number }}  ft² / {{ activeItem.size * 0.09290304 | number : 0 }} m²
					.project-detail-wrapper( ng-if='activeItem.program' )
						.project-detail-label
							| Program:
						.project-detail-text(
							ng-bind-html='activeItem.program | htmlParse'
							)
					.project-detail-wrapper( ng-if='activeItem.design_sdate && activeItem.design_edate' )
						.project-detail-label
							| Design:
						.project-detail-text(ng-if='(activeItem.design_sdate | date: "yyyy") != (activeItem.design_edate | date: "yyyy")')
							| {{ activeItem.design_sdate | date: "yyyy" }} - {{ activeItem.design_edate | date: "yyyy" }}
						.project-detail-text(ng-if='(activeItem.design_sdate | date: "yyyy") == (activeItem.design_edate | date: "yyyy")')
							| {{ activeItem.design_sdate | date: "yyyy" }}
					.project-detail-wrapper( ng-if='activeItem.constr_sdate || activeItem.constr_edate' )
						.project-detail-label
							| Construction:
						.project-detail-text(ng-if='(activeItem.constr_sdate | date: "yyyy") != (activeItem.constr_edate | date: "yyyy")')
							| {{ activeItem.constr_sdate | date: "yyyy" }} - {{ activeItem.constr_edate | date: "yyyy" }}
						.project-detail-text(ng-if='(activeItem.constr_sdate | date: "yyyy") == (activeItem.constr_edate | date: "yyyy")')
							| {{ activeItem.constr_sdate | date: "yyyy" }}
					.project-detail-wrapper( ng-if='activeItem.types.length' )
						.project-detail-label
							| {{ activeItem.types.length > 1 ? "Types":"Type" }}:
						.project-detail-text( ng-repeat='type in activeItem.types' )
							| {{ type }}
				
				//- Project Credits
				.project-page-sidebar-section(
					ng-toggle-class='contracted open'
					ng-if='activeItem.people.length && !mobile'
				)
					.project-page-sidebar-header
						| Project Credits
					
					.show-morph-team.details-clickable.contracted(
						ng-click='showMorphTeam = !showMorphTeam'
						ng-toggle-class='contracted open'
					)
						| Morphosis Team
					.project-detail-wrapper(
						ng-repeat='position in activeItem.morph_team'
						ng-show='showMorphTeam'
					)
						.project-detail-label
							| {{ position.role_title }}
						.project-detail-text.details-clickable(
							ng-repeat='person in position.people'
							ui-sref='root.section-state.project-state({ section: "about", projectId: person.person.id, m: "person" })'
							ng-bind-html='person.person.name | htmlParse'
						)
					.show-morph-team.details-clickable.contracted(
						ng-click='showConsultants = !showConsultants'
						ng-toggle-class='contracted open'
					)
						| Consultants
					.project-detail-wrapper(
						ng-repeat='position in activeItem.contractors'
						ng-show='showConsultants'
					)
						.project-detail-label
							| {{ position.role_title }}
						.project-detail-text.details-clickable(
							ng-repeat='person in position.people'
							ui-sref='root.section-state.project-state({ section: "about", projectId: person.person.id, m: "person" })'
							ng-bind-html='person.person.name | htmlParse'
						)

				//- Design recognition
				.project-page-sidebar-section(
					ng-if='activeItem.awards.length && !mobile'
				)
					.project-page-sidebar-header
						| Design Recognition

					.project-detail-wrapper( ng-repeat='(key, value) in activeItem.awards | groupBy: "-year"' )
						.project-detail-label
							| {{ key.slice(1) }}
						.project-detail-text.project-page-award( ng-repeat='award in value' )
							| {{ award.title }}

				//- Bibliography
				.project-page-sidebar-section( ng-if='!mobile' )

					.project-page-sidebar-header(
						ng-if='activeItem.bibliography_items.length'
					)
						| Bibliography
					.project-detail-wrapper.bibliography-item(
						ng-repeat='item in activeItem.bibliography_items'
					)
						.bibliography-image(
							ng-if='item.primary_image'
							preload-bg-image='{{ item.primary_image.name.thumb.url }}'
						)
						| {{ item.article_name ? '"' + item.article_name + '"' : '' }}
						| {{ item.author ? item.author : '' }}
						| {{ item.publication ? item.publication + '.' : '' }}
						| {{ item.publisher ? item.publisher : '' }}
						| {{ item.pub_date ? '(' + item.pub_date + ').' : '' }}
						| {{ item.pages ? item.pages + '.' : '' }}

			.project-page-main-text

				.project-overview(
					ng-if='activeItem.overview'
					ng-bind-html='activeItem.overview | htmlParse'
					ng-toggle-class='contracted open'
					ng-class='{ contracted: checkItemLength( activeItem.overview, 92 ) }'
				)
					| {{ activeItem.overview }}

				.project-description-wrapper(
					ng-toggle-class='contracted open'
					ng-if='activeItem.description'
					ng-class='{ contracted: checkItemLength( activeItem.description, 213 ) }'
				)
					.project-description-header
						| Description
					.project-description-body( ng-bind-html='activeItem.description | htmlParse' )

				.image-gallery-wrapper
					.image-gallery-section-wrapper.open(
						ng-repeat='gallery in activeItem.galleries'
						ng-mouseenter='startScroll( $event )'
						ng-mousemove='updateScroll( $event )'
						ng-mouseleave='stopScroll( )'
						ng-toggle-class='contracted open'
					)
						h1
							.arrow-left(ng-mouseenter='scrollLeft($event)' ng-mouseleave='stopScroll()')
							.arrow-right(ng-mouseover='scrollRight($event)' ng-mouseleave='stopScroll()')
							| {{ gallery.title }}

						.image-gallery-section.gallery(
							ng-click='$event.stopPropagation(  );'
						)
							a(
								ng-repeat='image in gallery.images'
								href='{{ image.name.name.url }}'
								data-caption='{{ image.credit }}'
							)
								img(
									ng-src='{{ image.name.name.thumb.url }}'
								)
				//- Components
				.project-description-wrapper.component.contracted(
					ng-repeat='component in activeItem.components | orderBy: "rank"'
					ng-toggle-class='contracted open'
				)
					.project-description-header
						| {{ component.title }}
					.project-description-body( ng-bind-html='component.content | htmlParse' )
				.project-description-wrapper.component.contracted(
					ng-toggle-class='contracted open'
					ng-if='activeItem.documents.length > 0'
				)
					| Documents
					.pdf-attachment(
						ng-repeat='document in activeItem.documents'
						ng-if='item.documents.length != 0'
					)
						a(
							href='{{ document.name.url }}'
							target='new'
						)
							| {{ document.name.url.split('/').reverse()[0] }}

			//- The remaining sidebar items for MOBILE (project credits + bibliography)
			.project-page-second-sidebar(
				ng-if='mobileAndTabletCheck(  ) && ( activeItem.people.length || activeItem.awards.length || activeItem.bibliography_items.length )'
			)
				.project-page-sidebar-section.project-credits.contracted(
					ng-if='activeItem.people.length'
					ng-toggle-class='contracted open'
				)
					.project-page-sidebar-header
						| Project Credits
					
					.show-morph-team.details-clickable.contracted(
						ng-click='showMorphTeam = !showMorphTeam'
						ng-toggle-class='contracted open'
					)
						| Morphosis Team
					.project-detail-wrapper(
						ng-repeat='position in activeItem.morph_team'
						ng-show='showMorphTeam'
					)
						.project-detail-label
							| {{ position.role_title }}
						.project-detail-text.details-clickable(
							ng-repeat='person in position.people'
							ui-sref='root.section-state.project-state({ section: "about", projectId: person.person.id, m: "person" })'
							ng-bind-html='person.person.name | htmlParse'
						)
					.show-morph-team.details-clickable.contracted(
						ng-click='showConsultants = !showConsultants'
						ng-toggle-class='contracted open'
					)
						| Consultants
					.project-detail-wrapper(
						ng-repeat='position in activeItem.contractors'
						ng-show='showConsultants'
					)
						.project-detail-label
							| {{ position.role_title }}
						.project-detail-text.details-clickable(
							ng-repeat='person in position.people'
							ui-sref='root.section-state.project-state({ section: "about", projectId: person.person.id, m: "person" })'
							ng-bind-html='person.person.name | htmlParse'
						)


				//- Design recognition
				.project-page-sidebar-section.contracted(
					ng-if='activeItem.awards.length'
					ng-toggle-class='open contracted'
				)
					.project-page-sidebar-header
						| Design Recognition

					.project-detail-wrapper( ng-repeat='(key, value) in activeItem.awards | groupBy: "-year"' )
						.project-detail-label
							| {{ key.slice( 1 ) }}
						.project-detail-text.project-page-award( ng-repeat='award in value' )
							| {{ award.title }}

				//- Bibliography
				.project-page-sidebar-section.contracted(
					ng-toggle-class='open contracted'
					ng-if='activeItem.bibliography_items.length'
				)

					.project-page-sidebar-header(
						ng-if='activeItem.bibliography_items.length'
					)
						| Bibliography
					.project-detail-wrapper.bibliography-item.details-clickable(
						ng-repeat='item in activeItem.bibliography_items'
						//ui-sref='root.section-state.sorting-state({ section: "about", sortingType: "media", q: "bibliography", e: item.uid, m: null, s: null })'
					)
						.bibliography-image(
							ng-if='item.primary_image'
							preload-bg-image='{{ item.primary_image.name.thumb.url }}'
						)
						| {{ item.author ? item.author : '' }}
						| {{ item.publication ? item.publication + '.' : '' }}
						| {{ item.publisher ? item.publisher : '' }}
						| {{ item.pub_date ? '(' + item.pub_date + ').' : '' }}
						| {{ item.pages ? item.pages + '.' : '' }}

		//- PEOPLE PAGE
		.project-page-text-wrapper( ng-if='stateParams.m == "person"' )

			.project-page-sidebar
				.project-page-sidebar-header( ng-if='activeItem.educations.length' )
					| Education
				.project-detail-wrapper( ng-repeat='education in activeItem.educations' )
					| {{ education.title }}
				.project-page-sidebar-header( ng-if='activeItem.email' )
					| Contact
				.project-detail-wrapper
					a( href='mailto:{{ activeItem.email }}' )
						| {{ activeItem.email }}
				

			.project-page-main-text
				.project-overview(
					ng-if='activeItem.location'
					ng-bind-html='activeItem.location | htmlParse'
				)

				.project-description-wrapper
					.project-description-header( ng-if='activeItem.description' )
						| Description
					.project-description-body( ng-bind-html='activeItem.description | htmlParse' )

				.project-description-header(ng-if='activeItem.roles.length > 0')
					| Related Projects

				.project-detail-wrapper( ng-repeat='(key, value) in activeItem.roles | groupBy: "title"' )
					.project-detail-label
						| {{ key + ': '}}
					.project-detail-text.details-clickable( ng-repeat='role in value' ui-sref='root.section-state.project-state({ section: "architecture", projectId: role.project.id, m: "project", s: null, e: null })')
						| {{ role.project.title }}
